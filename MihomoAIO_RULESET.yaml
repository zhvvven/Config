# Name: MihomoAllInOne_Full
# Designer: zhvvven
# Version: v2
# Date: 2026-01-28

mixed-port: 7890
allow-lan: true
unified-delay: true
tcp-concurrent: true
external-controller: 127.0.0.1:9090

geodata-loader: standard
geo-auto-update: true
geo-update-interval: 24
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"

find-process-mode: strict
keep-alive-interval: 1800
global-client-fingerprint: random

profile:
  store-selected: true
  store-fake-ip: true

sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - 'geosite:cn,private'

tun:
  enable: true
  stack: mixed
  device: mihomo
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  auto-detect-interface: true
  strict-route: true

dns:
  enable: true
  cache-algorithm: arc
  listen: 0.0.0.0:1053
  prefer-h3: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "geosite:cn,private"
    - "*.msftconnecttest.com"
    - "*.msftncsi.com"
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://sm2.doh.pub/dns-query
    - https://doh.onedns.net/dns-query
    - quic://223.5.5.5:853
    - quic://223.6.6.6:853
  nameserver-policy:
    "geosite:gfw,geolocation-!cn":
      - https://1.1.1.1/dns-query
      - https://8.8.8.8/dns-query
    "geosite:cn,private":
      - https://dns.alidns.com/dns-query
      - https://sm2.doh.pub/dns-query
      - https://doh.onedns.net/dns-query

Providers: &Providers {type: http, interval: 86400, health-check: {enable: true, url: 'https://connectivitycheck.gstatic.com/generate_204', interval: 300}, exclude-filter: '(?i)æµé‡|å€ç‡|è½®è¯¢|ç¾¤|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|å¤±è”|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|COM|USE|USED|TOTAL|EXPIRE|EMAIL|Panel|Channel|Author'}
Select: &Select {type: select, interval: 300, lazy: true, url: 'https://connectivitycheck.gstatic.com/generate_204'}
UrlTest: &UrlTest {type: url-test, interval: 30, tolerance: 20, lazy: true, url: 'https://connectivitycheck.gstatic.com/generate_204', hidden: true}
Balance: &Balance {type: load-balance, interval: 30, lazy: true, url: 'https://connectivitycheck.gstatic.com/generate_204', strategy: consistent-hashing, hidden: true}
FallBack: &FallBack {type: fallback, interval: 30, lazy: true, url: 'https://connectivitycheck.gstatic.com/generate_204', hidden: true}

Used: &Used [é£å…”äº‘, æ·˜æ°”å…”, ä¹æœˆé¹¿, é˜¿æ‹‰ä¸]
FilterHK: &FilterHK "(?i)é¦™æ¸¯|ğŸ‡­ğŸ‡°|HK|Hong"
FilterSG: &FilterSG "(?i)æ–°åŠ å¡|ğŸ‡¸ğŸ‡¬|SG|Singapore"
FilterJP: &FilterJP "(?i)æ—¥æœ¬|ğŸ‡¯ğŸ‡µ|JP|Japan"
FilterKR: &FilterKR "(?i)éŸ©å›½|ğŸ‡°ğŸ‡·|KR|Korea"
FilterUS: &FilterUS "(?i)ç¾å›½|ğŸ‡ºğŸ‡¸|US|America|United States"

cyaml: &cyaml {type: http, behavior: classical, interval: 864000}
dyaml: &dyaml {type: http, behavior: domain, interval: 864000}
iyaml: &iyaml {type: http, behavior: ipcidr, interval: 864000}
ctxt: &ctxt {type: http, behavior: classical, format: text, interval: 864000}
dtxt: &dtxt {type: http, behavior: domain, format: text, interval: 864000}
itxt: &itxt {type: http, behavior: ipcidr, format: text, interval: 864000}
dmrs: &dmrs {type: http, behavior: domain, format: mrs, interval: 864000}
imrs: &imrs {type: http, behavior: ipcidr, format: mrs, interval: 864000}

proxy-providers:
  é£å…”äº‘:
    <<: *Providers
    url:
    path: ./providers/é£å…”äº‘.yaml
    override:
      additional-prefix: "[é£å…”]"
  æ·˜æ°”å…”:
    <<: *Providers
    url:
    path: ./providers/æ·˜æ°”å…”.yaml
    override:
      additional-prefix: "[æ·˜æ°”]"
  ä¹æœˆé¹¿:
    <<: *Providers
    url:
    path: ./providers/ä¹æœˆé¹¿.yaml
    override:
      additional-prefix: "[ä¹æœˆé¹¿]"
  é˜¿æ‹‰ä¸:
    <<: *Providers
    url:
    path: ./providers/é˜¿æ‹‰ä¸.yaml
    override:
      additional-prefix: "[é˜¿æ‹‰ä¸]"

proxy-groups:
  - {name: èŠ‚ç‚¹é€‰æ‹©, type: select, proxies: [é¦™æ¸¯è‡ªåŠ¨, æ—¥æœ¬è‡ªåŠ¨, ç‹®åŸè‡ªåŠ¨, éŸ©å›½è‡ªåŠ¨, ç¾å›½è‡ªåŠ¨], icon: https://testingcf.jsdelivr.net/gh/Semporia/Hand-Painted-icon@master/Universal/Airport.png}
  - {name: äººå·¥æ™ºéšœ, <<: *Select, use: *Used, filter: *FilterUS, icon: https://testingcf.jsdelivr.net/gh/NB921/picture@main/chatgpt.png}
  - {name: ç”µæŠ¥ä¿¡æ¯, <<: *Select, use: *Used, filter: *FilterSG, icon: https://testingcf.jsdelivr.net/gh/NB921/picture@main/Telegram.png}
  - {name: æ²¹ç®¡æ— å¹¿, <<: *Select, use: *Used, filter: "(?i)ä¿„ç½—æ–¯|ğŸ‡·ğŸ‡º|Russia", proxies: [èŠ‚ç‚¹é€‰æ‹©], icon: https://testingcf.jsdelivr.net/gh/NB921/picture@main/Youtube1.png}
  - {name: é¦™æ¸¯è‡ªåŠ¨, <<: *UrlTest, use: *Used, filter: *FilterHK}
  - {name: æ—¥æœ¬è‡ªåŠ¨, <<: *UrlTest, use: *Used, filter: *FilterJP}
  - {name: ç‹®åŸè‡ªåŠ¨, <<: *UrlTest, use: *Used, filter: *FilterSG}
  - {name: éŸ©å›½è‡ªåŠ¨, <<: *UrlTest, use: *Used, filter: *FilterKR}
  - {name: ç¾å›½è‡ªåŠ¨, <<: *UrlTest, use: *Used, filter: *FilterUS}

rule-providers:
  telegramIP: {<<: *imrs, url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.mrs, path: ./ruleset/telegramIP.mrs}
  telegramSITE: {<<: *dmrs, url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.mrs, path: ./ruleset/telegramSITE.mrs}
  category-ai-!cn: {<<: *dmrs, url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/category-ai-!cn.mrs, path: ./ruleset/category-ai-!cn.mrs}
  youtube: {<<: *dmrs, url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/youtube.mrs, path: ./ruleset/youtube.mrs}
  category-games@cn: {<<: *dmrs, url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/category-games@cn.mrs, path: ./ruleset/category-games@cn.mrs}
  anti-AD: {<<: *dyaml, url: https://anti-ad.net/clash.yaml, path: ./ruleset/anti-AD.yaml}
  AdRules: {<<: *dmrs, url: https://adrules.top/adrules-mihomo.mrs, path: ./ruleset/AdRules.mrs}
  cnSITE: {<<: *dmrs, url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/cn.mrs, path: ./ruleset/cnSITE.mrs}
  cnIP: {<<: *imrs, url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.mrs, path: ./ruleset/cnIP.mrs}

rules:
  - DOMAIN-SUFFIX, api.chatanywhere.tech, DIRECT
  - DOMAIN-SUFFIX, bing.com, DIRECT
  - RULE-SET, anti-AD, REJECT
  - RULE-SET, AdRules, REJECT
  - RULE-SET, telegramIP, ç”µæŠ¥ä¿¡æ¯
  - RULE-SET, telegramSITE, ç”µæŠ¥ä¿¡æ¯
  - RULE-SET, category-ai-!cn, äººå·¥æ™ºéšœ
  - RULE-SET, youtube, æ²¹ç®¡æ— å¹¿
  - RULE-SET, category-games@cn, DIRECT
  - RULE-SET, cnSITE, DIRECT
  - RULE-SET, cnIP, DIRECT
  - MATCH, èŠ‚ç‚¹é€‰æ‹©
